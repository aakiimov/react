{"version":3,"sources":["store/constants/user.ts","store/reducers/user/index.ts","store/reducers/index.ts","store/sagas/worker/fetchAccessToken.ts","store/sagas/watcher/fetchAccessToken.ts","store/sagas/watcher/index.ts","store/index.ts","store/actions/user/index.ts","panels/Catalog/Catalog.tsx","components/Dashboard/modules/Card/Card.tsx","components/Dashboard/Dashboard.tsx","components/Contacts/Contacts.tsx","types/tabRoute.ts","components/Informer/Informer.tsx","panels/App/App.tsx","views/App/App.tsx","views/Catalog/Catalog.tsx","router.tsx","app.tsx","index.tsx"],"names":["SET_USER","FETCH_ACCESS_TOKEN","initialState","access_token","getUserState","state","user","combineReducers","action","type","constants","payload","fetchAccessTokenWorker","bridge","send","catch","alert","response","put","fetchAccessTokenWatcher","takeLatest","watcher","all","sagaMiddleware","createSagaMiddleware","store","createStore","reducer","composeWithDevTools","applyMiddleware","logger","createBrowserHistory","run","fetchAccessToken","CatalogPanel","props","id","dashboardCard","block","DashboardCard","className","subtitle","title","Dashboard","header","mode","size","TabRoute","connect","React","useState","friends","setFriends","useEffect","method","params","order","fields","v","then","data","items","error","console","map","friend","before","src","photo_100","first_name","last_name","renderFriends","Informer","disabled","onClick","onModalShow","AppPanel","onShowModal","AppView","activeModal","setActiveModal","modal","onClose","left","right","top","placeholder","activePanel","modalName","CatalogView","dispatch","bindActionCreators","App","activeStory","setActiveStory","onStoryChange","e","currentTarget","dataset","story","tabbar","selected","Catalog","data-story","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.ab9200b2.chunk.js","sourcesContent":["export const SET_USER = 'SET_USER';\nexport const FETCH_ACCESS_TOKEN = 'FETCH_ACCESS_TOKEN';","import * as constants from '../../constants/user';\nimport { UserAction } from '../../actions/user/types';\nimport { IUserState } from './types';\nimport {IState} from \"../../types/state\";\n\nconst initialState: IUserState = {\n  access_token: ''\n};\n\n/**\n * The user reducer.\n *\n * @param state\n * @param action\n */\nexport function userReducer(state = initialState, action: UserAction) {\n  switch (action.type) {\n    case constants.SET_USER: {\n      return action.payload.user;\n    }\n\n    default: return state;\n  }\n}\n\n/**\n * The function return user state.\n *\n * @param state\n */\nexport const getUserState = (state: IState) => state.user;","import { combineReducers } from 'redux';\nimport { IState } from '../types/state';\n\n/**\n * Reducer's.\n */\nimport { userReducer } from './user';\n\n/**\n * The root reducer.\n */\nexport default combineReducers<IState>({\n  user: userReducer\n})","import { put } from 'redux-saga/effects';\nimport bridge from '@vkontakte/vk-bridge';\nimport { ISetUserAction } from '../../actions/user/types';\nimport { SET_USER } from '../../constants/user';\n\nexport function* fetchAccessTokenWorker() {\n  const response = yield bridge.send('VKWebAppGetAuthToken', {\n    'app_id': 7712603,\n    'scope': 'friends'\n  }).catch(() => {\n    alert('Прроизошло критическая ошибка. Пожалуйста, перезагрузите приложение.')\n  });\n\n  yield put<ISetUserAction>({\n    type: SET_USER,\n    payload: {\n      user: {\n        access_token: response.access_token\n      }\n    }\n  });\n}","import { takeLatest } from 'redux-saga/effects';\nimport { FETCH_ACCESS_TOKEN } from '../../constants/user';\nimport { fetchAccessTokenWorker } from '../worker/fetchAccessToken';\n\nexport function* fetchAccessTokenWatcher() {\n  yield takeLatest(FETCH_ACCESS_TOKEN, fetchAccessTokenWorker);\n}","import { all } from 'redux-saga/effects';\nimport { fetchAccessTokenWatcher } from './fetchAccessToken';\n\nexport default function* watcher() {\n  yield all([\n    fetchAccessTokenWatcher()\n  ]);\n}","import { createStore, applyMiddleware } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport logger from 'redux-logger';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport reducer from './reducers';\nimport watcher from './sagas/watcher';\nimport { createBrowserHistory } from 'history';\n\nconst sagaMiddleware = createSagaMiddleware();\nconst store = createStore(reducer, composeWithDevTools(applyMiddleware(logger, sagaMiddleware)));\nconst history = createBrowserHistory();\n\nsagaMiddleware.run(watcher);\n\nexport { store, history };","import * as constants from '../../constants/user';\nimport { ISetUserAction, UserAction } from './types';\n\n/**\n * The set user action.\n *\n * @param payload\n */\nexport function setUser(payload: ISetUserAction['payload']): UserAction {\n  return {\n    type: constants.SET_USER,\n    payload\n  };\n}\n\n/**\n * The fetch access token action.\n */\nexport function fetchAccessToken(): UserAction {\n  return {\n    type: constants.FETCH_ACCESS_TOKEN,\n  };\n}","import React from 'react';\nimport { Panel, PanelHeader } from '@vkontakte/vkui';\nimport IPanelProps from \"../../types/panelProps\";\n\n/**\n * The catalog panel.\n *\n * @param props\n * @constructor\n */\nexport default function CatalogPanel(props: IPanelProps): React.ReactElement {\n  return (\n    <Panel id={props.id}>\n      <PanelHeader>Каталог</PanelHeader>\n    </Panel>\n  );\n}","import React from 'react';\nimport { block } from 'bem-cn';\nimport { Card as CardWrapper } from '@vkontakte/vkui';\nimport { IDashboardCardProps } from './types';\nimport './styles.scss';\n\n/**\n * The class generator.\n */\nconst dashboardCard = block('dashboard-card');\n\n/**\n * The dashboard card module.\n *\n * @param props\n * @constructor\n */\nexport default function DashboardCard(props: IDashboardCardProps): React.ReactElement {\n  return (\n    <CardWrapper>\n      <div className={dashboardCard()}>\n        <span className={dashboardCard('subtitle')}>{props.subtitle}</span>\n        <strong className={dashboardCard('title')}>{props.title}</strong>\n      </div>\n    </CardWrapper>\n  );\n}","import React from 'react';\nimport { CardScroll, Group, Header } from '@vkontakte/vkui';\nimport { DashboardCard } from './modules';\n\n/**\n * The dashboard component.\n *\n * @constructor\n */\nexport default function Dashboard(): React.ReactElement {\n  return (\n    <Group header={<Header mode=\"primary\">Активные долги</Header>} mode=\"plain\">\n      <CardScroll size=\"m\">\n        <DashboardCard\n          subtitle=\"Дал в долг\"\n          title=\"125 000 ₽\"\n        />\n      </CardScroll>\n    </Group>\n  )\n}","import React from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport { connect } from 'react-redux';\nimport { Avatar, Group, Header, SimpleCell } from '@vkontakte/vkui';\nimport { IState } from \"../../store/types/state\";\nimport { getUserState } from \"../../store/reducers/user\";\nimport { IContactsProps, IFriend } from './types';\n\n/**\n * The contacts component.\n *\n * @constructor\n */\nfunction Contacts(props: IContactsProps): React.ReactElement {\n  const [friends, setFriends] = React.useState<IFriend[]>([]);\n\n  React.useEffect(() => {\n    bridge.send('VKWebAppCallAPIMethod', {\n      method: 'friends.get',\n      params: {\n        order: 'hints',\n        fields: 'nickname,photo_100',\n        v: '5.21',\n        access_token: props.access_token\n      }\n    })\n      .then((data: any) => setFriends(data.response.items))\n      .catch((error) => console.error(error));\n  }, [props]);\n\n  /**\n   * The function render friends.\n   * @param friends\n   */\n  function renderFriends(friends: IFriend[]) {\n    return friends.map((friend) => (\n      <SimpleCell before={<Avatar src={friend.photo_100} size={48} />}>\n        {friend.first_name} {friend.last_name}\n      </SimpleCell>\n    ))\n  }\n\n  return (\n    <Group header={<Header mode=\"primary\">Контакты</Header>} mode=\"plain\">\n      {renderFriends(friends)}\n    </Group>\n  )\n}\n\nconst mapStateToProps = (state: IState) => ({\n  access_token: getUserState(state).access_token\n});\n\nexport default connect(mapStateToProps)(Contacts);","/**\n * The tab routes with names.\n */\nenum TabRoute {\n  'Catalog' = 'catalog',\n  'App' = 'app'\n}\n\nexport default TabRoute;","import React from 'react';\nimport { Group, Header, CellButton } from '@vkontakte/vkui';\nimport { Icon24HistoryBackwardOutline, Icon24Add } from '@vkontakte/icons';\nimport { IInformerProps } from \"./types\";\n\n/**\n * The informer component.\n *\n * @constructor\n */\nexport default function Informer(props: IInformerProps): React.ReactElement {\n  return (\n    <Group header={<Header mode=\"secondary\">Нет просроченных долгов</Header>}>\n      <CellButton before={<Icon24HistoryBackwardOutline />} disabled>\n        Показать статистику\n      </CellButton>\n      <CellButton\n        before={<Icon24Add />}\n        onClick={() => props.onModalShow && props.onModalShow('add-debt')}>\n        Добавить долг\n      </CellButton>\n    </Group>\n  );\n}","import React from 'react';\nimport { Panel, PanelHeader } from '@vkontakte/vkui';\nimport { Informer, Contacts, Dashboard } from '../../components';\nimport IPanelProps from \"../../types/panelProps\";\n\n/**\n * The app panel.\n *\n * @param props\n * @constructor\n */\nexport default function AppPanel(props: IPanelProps): React.ReactElement {\n  return (\n    <Panel id={props.id}>\n      <PanelHeader>Долги</PanelHeader>\n      <Informer onModalShow={props.onShowModal} />\n      <Dashboard />\n      <Contacts />\n    </Panel>\n  );\n}","import React from 'react';\nimport { View, ModalRoot, ModalPage, ModalPageHeader, PanelHeaderButton, Group, FormItem, Input } from '@vkontakte/vkui';\nimport { Icon24Cancel, Icon24Done } from '@vkontakte/icons';\nimport { AppPanel } from \"../../panels\";\nimport { ViewProps } from \"@vkontakte/vkui/dist/components/View/View\";\nimport { PanelProps } from \"@vkontakte/vkui/dist/components/Panel/Panel\";\nimport IModal from \"../../types/modal\";\n\n/**\n * The app view.\n *\n * @constructor\n */\nexport default function AppView(props: ViewProps & PanelProps): React.ReactElement {\n  const [activeModal, setActiveModal] = React.useState<IModal | null>(null);\n\n  /**\n   * The function show modal.\n   * @param modalName\n   */\n  function onShowModal(modalName: string): void {\n    return setActiveModal(modalName);\n  }\n\n  /**\n   * The function cancel modal.\n   */\n  function onCancelModal(): void {\n    return setActiveModal(null);\n  }\n\n  const modal = (\n    <ModalRoot activeModal={activeModal} onClose={onCancelModal}>\n      <ModalPage id=\"add-debt\" header={\n        <ModalPageHeader\n          left={\n            <PanelHeaderButton onClick={() => setActiveModal(null)}>\n              <Icon24Cancel />\n            </PanelHeaderButton>\n          }\n          right={\n            <PanelHeaderButton>\n              <Icon24Done />\n            </PanelHeaderButton>\n          }\n        >Добавить долг</ModalPageHeader>\n      }>\n        <Group>\n          <FormItem top=\"Сумма\">\n            <Input placeholder=\"К примеру: 347 ₽\" />\n          </FormItem>\n        </Group>\n      </ModalPage>\n    </ModalRoot>\n  );\n\n  return (\n    <View id={props.id} modal={modal} activePanel={props.activePanel}>\n      <AppPanel id={props.id} onShowModal={onShowModal} />\n    </View>\n  );\n}","import React from 'react';\nimport { View } from '@vkontakte/vkui';\nimport { CatalogPanel } from \"../../panels\";\nimport { ViewProps } from \"@vkontakte/vkui/dist/components/View/View\";\nimport { PanelProps } from \"@vkontakte/vkui/dist/components/Panel/Panel\";\n\n/**\n * The catalog view.\n *\n * @constructor\n */\nexport default function CatalogView(props: ViewProps & PanelProps): React.ReactElement {\n  return (\n    <View id={props.id} activePanel={props.activePanel}>\n      <CatalogPanel id={props.id} />\n    </View>\n  );\n}","import React from 'react';\nimport { bindActionCreators, Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport { AppRoot, Epic, Tabbar, TabbarItem, View } from '@vkontakte/vkui';\nimport { Icon28BookOutline, Icon28ServicesOutline } from '@vkontakte/icons';\nimport { fetchAccessToken } from './store/actions/user';\nimport { CatalogView, AppView } from './views';\nimport { IRouterProps, IStory, TabRoute } from './types';\n\n/**\n * The app router.\n *\n * @constructor\n */\nfunction Router(props: IRouterProps): React.ReactElement {\n  const [activeStory, setActiveStory] = React.useState<IStory>(TabRoute.App);\n\n  React.useEffect(() => {\n    props.fetchAccessToken();\n  }, [props]);\n\n  function onStoryChange(e: any): void {\n    return setActiveStory(e.currentTarget.dataset.story);\n  }\n\n  return (\n    <AppRoot>\n      <Epic activeStory={activeStory} tabbar={\n        <Tabbar>\n          <TabbarItem\n            onClick={onStoryChange}\n            selected={activeStory === TabRoute.Catalog}\n            data-story={TabRoute.Catalog}\n          ><Icon28BookOutline /></TabbarItem>\n          <TabbarItem\n            onClick={onStoryChange}\n            selected={activeStory === TabRoute.App}\n            data-story={TabRoute.App}\n          ><Icon28ServicesOutline /></TabbarItem>\n        </Tabbar>\n      }>\n        <CatalogView id={TabRoute.Catalog} activePanel={TabRoute.Catalog} />\n        <AppView id={TabRoute.App} activePanel={TabRoute.App} />\n      </Epic>\n    </AppRoot>\n  );\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  fetchAccessToken: bindActionCreators(fetchAccessToken, dispatch)\n});\n\nexport default connect(null, mapDispatchToProps)(Router);","import React from 'react';\nimport { Provider } from 'react-redux';\nimport { store } from './store';\nimport Router from './router';\n\n/**\n * The root app component.\n *\n * @constructor\n */\nexport default function App(): React.ReactElement {\n  return (\n    <Provider store={store}>\n      <Router />\n    </Provider>\n  );\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './app';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}